<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OBSESSION</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;600;900&family=Cinzel:wght@400;600;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

<script>
function _d(e){try{return CryptoJS.AES.decrypt(e,'OBS3SS10N_mlplsk20').toString(CryptoJS.enc.Utf8)}catch(t){return''}}
</script>
</head>
<body>
    <!-- Ëá™ÂÆö‰πâÊèêÁ§∫Ê°Ü -->
    <div id="customAlert" class="custom-alert">
        <div class="custom-alert-content">
            <div class="custom-alert-message" id="alertMessage"></div>
            <button class="custom-alert-button" onclick="Alert.close()">Á°ÆÂÆö</button>
        </div>
    </div>

    <!-- Ëá™ÂÆö‰πâÁ°ÆËÆ§Ê°Ü -->
    <div id="customConfirm" class="custom-alert">
        <div class="custom-alert-content">
            <div class="custom-alert-message" id="confirmMessage"></div>
            <div class="confirm-buttons">
                <button class="confirm-button-cancel" onclick="Confirm.cancel()">ÂèñÊ∂à</button>
                <button class="confirm-button-ok" onclick="Confirm.ok()">Á°ÆÂÆö</button>
            </div>
        </div>
    </div>
    
    <!-- ÊèêÁ§∫ËØçÁºñËæëÂºπÁ™ó -->
    <div id="promptEditModal" class="prompt-edit-modal">
        <div class="prompt-edit-overlay" onclick="MemorySettings.closePromptEdit()"></div>
        <div class="prompt-edit-content">
            <div class="prompt-edit-header">
                <h3 id="promptEditTitle" class="prompt-edit-title">ÁºñËæëÊèêÁ§∫ËØç</h3>
                <button class="side-panel-close" onclick="MemorySettings.closePromptEdit()">‚úï</button>
            </div>
            <div class="prompt-edit-body">
                <textarea id="promptEditTextarea" class="prompt-edit-textarea" placeholder="ËØ∑ËæìÂÖ•ÊèêÁ§∫ËØç..."></textarea>
            </div>
            <div class="prompt-edit-footer">
                <button class="confirm-button-cancel" onclick="MemorySettings.closePromptEdit()">ÂèñÊ∂à</button>
                <button class="confirm-button-ok" onclick="MemorySettings.savePromptEdit()">‰øùÂ≠ò</button>
            </div>
        </div>
    </div>

    <!-- Â∑¶‰∏äËßíÈîêÂà©Ë£ÖÈ•∞ÂÖÉÁ¥† -->
    <div class="corner-accent"></div>
    
    <!-- Ë£ÖÈ•∞ÂÖÉÁ¥† -->
    <div class="decorations">
        <div class="corner corner-tl"></div>
        <div class="corner corner-tr"></div>
        <div class="corner corner-bl"></div>
        <div class="corner corner-br"></div>
    </div>

    <!-- ‰∏ªÂÆπÂô® -->
    <div class="container">
        <div class="title-section">
            <h1 class="title-main">OBSESSION</h1>
            <p class="title-sub">‰∏ñÁïå‰∏áÂçÉÔºå‰∏ÄÂøµÊâÄÂêë</p>
            <div class="accent-line">
                <div class="accent-dot"></div>
            </div>
        </div>

        <div class="actions">
            <button class="btn btn-primary" id="newCharacter">
                <span class="btn-text">
                    <span class="btn-text__cn">Êñ∞Âª∫ËßíËâ≤</span>
                    <span class="btn-text__en">New Character</span>
                </span>
                <span class="btn-icon">‚Üí</span>
            </button>

            <button class="btn btn-secondary" id="importCharacter">
                <span class="btn-text">
                    <span class="btn-text__cn">ÂØºÂÖ•ËßíËâ≤</span>
                    <span class="btn-text__en">Import Character</span>
                </span>
                <span class="btn-icon">‚Üë</span>
            </button>
        </div>
    </div>

    <div class="footer-hint">- Local Storage -</div>

    <!-- Á≥ªÁªüÁªëÂÆöÂºïÂØºÈ°µÂÜÖÂÆπ -->
    <div id="bindingSection" class="hidden-section">
        <!-- Â∑¶‰æßÁ´ñÁ∫ø - Áã¨Á´ãÂõ∫ÂÆö -->
        <div class="vertical-line"></div>
        
        <!-- ÊªöÂä®ÂÆπÂô® -->
        <div class="scroll-container">
            <div class="content-wrapper">
                <div class="system-beep">ÂèÆ‚Äî‚Äî</div>
                
                <div class="dialogue-text">
                    <p class="dialogue-paragraph" id="line1"></p>
                    <p class="dialogue-paragraph" id="line2"></p>
                    <p class="dialogue-paragraph" id="line3"></p>
                    <p class="dialogue-paragraph" id="line4"></p>
                    <p class="dialogue-paragraph" id="line5"></p>
                    <p class="dialogue-paragraph" id="line6"></p>
                    <p class="dialogue-paragraph" id="line7"></p>
                    <p class="dialogue-paragraph" id="line8"></p>
                </div>

                <button class="continue-btn" id="continueBtn">
                    <span class="continue-btn-text">ËøõÂÖ•ÈÖçÁΩÆ ‚Üí</span>
                </button>
            </div>
        </div>
    </div>

    <!-- APIÈÖçÁΩÆÈ°µÈù¢ -->
    <div id="apiConfigSection">
        <div class="config-container">
            <h1 class="config-title">Á≥ªÁªüÈÖçÁΩÆ</h1>
            
            <!-- APIÈÖçÁΩÆË°®ÂçïÔºàÂèØÁßªÂä®Âà∞ËÆæÁΩÆÈù¢ÊùøÔºâ -->
            <div id="api-config-form">
                <!-- ÂØπËØùÊ®°ÂûãÈÖçÁΩÆ -->
                <div class="model-config-block">
                    <h4 class="block-title">ÂØπËØùÊ®°Âûã</h4>
                
                <div class="form-group">
                    <label class="form-label">ÊúçÂä°ÂïÜ</label>
                    <div class="custom-select-wrapper">
                        <div class="custom-select" data-select="cfg-provider">
                            <span class="custom-select-value">Ëá™ÂÆö‰πâ</span>
                            <svg class="custom-select-arrow" viewBox="0 0 12 8" fill="none">
                                <path d="M1 1L6 6L11 1" stroke="#d4879c" stroke-width="2"/>
                            </svg>
                        </div>
                        <div class="custom-select-dropdown">
                            <div class="custom-select-option selected" data-value="custom">Ëá™ÂÆö‰πâ</div>
                            <div class="custom-select-option" data-value="openai">OpenAI</div>
                            <div class="custom-select-option" data-value="openrouter">Open Router</div>
                            <div class="custom-select-option" data-value="gemini">Google AI Studio</div>
                            <div class="custom-select-option" data-value="deepseek">DeepSeek</div>
                            <div class="custom-select-option" data-value="siliconflow">SiliconFlow</div>
                        </div>
                    </div>
                    <!-- ÈöêËóèÁöÑÂéüÁîüselectÔºåÁî®‰∫é‰øùÂ≠òÂÄº -->
                    <select class="form-select" id="cfg-provider" onchange="Settings.onProviderChange('chat')" style="display: none;">
                        <option value="custom">Ëá™ÂÆö‰πâ</option>
                        <option value="openai">OpenAI</option>
                        <option value="openrouter">Open Router</option>
                        <option value="gemini">Google AI Studio</option>
                        <option value="deepseek">DeepSeek</option>
                        <option value="siliconflow">SiliconFlow</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Êé•Âè£Âú∞ÂùÄ</label>
                    <input type="text" class="form-input" id="cfg-url" name="api-chat-url" placeholder="https://api.example.com/v1" oninput="Settings.autoSave()" onchange="Settings.autoSave()">
                </div>
                
                <div class="form-group">
                    <label class="form-label">ÂØÜÈí•</label>
                    <input type="password" class="form-input" id="cfg-key" name="api-chat-key" placeholder="sk-..." oninput="Settings.autoSave()" onchange="Settings.autoSave()">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Ê®°ÂûãÂêçÁß∞</label>
                    <div class="button-group">
                        <div class="model-input-flex">
                            <input type="text" class="form-input" id="cfg-model" name="api-chat-model" placeholder="gpt-4" oninput="Settings.filterModels('chat'); Settings.autoSave();" onchange="Settings.autoSave()">
                            <div class="model-list" id="model-list-chat"></div>
                        </div>
                        <button class="btn-scan" id="btn-scan-chat" onclick="Settings.fetchModels('chat')">Êâ´Êèè</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <button class="btn-test-api" id="btn-test-chat" onclick="Settings.testAPI('chat')">ÊµãËØïËøûÊé•</button>
                </div>
            </div>
            
            <!-- ËÆ∞ÂøÜÊ®°ÂûãÈÖçÁΩÆ -->
            <div class="model-config-block">
                <h4 class="block-title">ËÆ∞ÂøÜÊ®°Âûã</h4>
                
                <label class="checkbox-group">
                    <input type="checkbox" checked id="cfg-func-same" onchange="Settings.toggleFuncExtra()">
                    <span class="checkbox-label">‰ΩøÁî®Áõ∏ÂêåÈÖçÁΩÆ</span>
                </label>
                
                <div id="func-extra" class="func-extra-hidden">
                    <div class="form-group">
                        <label class="form-label">ÊúçÂä°ÂïÜ</label>
                        <div class="custom-select-wrapper">
                            <div class="custom-select" data-select="cfg-func-provider">
                                <span class="custom-select-value">Ëá™ÂÆö‰πâ</span>
                                <svg class="custom-select-arrow" viewBox="0 0 12 8" fill="none">
                                    <path d="M1 1L6 6L11 1" stroke="#d4879c" stroke-width="2"/>
                                </svg>
                            </div>
                            <div class="custom-select-dropdown">
                                <div class="custom-select-option selected" data-value="custom">Ëá™ÂÆö‰πâ</div>
                                <div class="custom-select-option" data-value="openai">OpenAI</div>
                                <div class="custom-select-option" data-value="openrouter">Open Router</div>
                                <div class="custom-select-option" data-value="gemini">Google AI Studio</div>
                                <div class="custom-select-option" data-value="deepseek">DeepSeek</div>
                                <div class="custom-select-option" data-value="siliconflow">SiliconFlow</div>
                            </div>
                        </div>
                        <!-- ÈöêËóèÁöÑÂéüÁîüselectÔºåÁî®‰∫é‰øùÂ≠òÂÄº -->
                        <select class="form-select" id="cfg-func-provider" onchange="Settings.onProviderChange('func')" style="display: none;">
                            <option value="custom">Ëá™ÂÆö‰πâ</option>
                            <option value="openai">OpenAI</option>
                            <option value="openrouter">Open Router</option>
                            <option value="gemini">Google AI Studio</option>
                            <option value="deepseek">DeepSeek</option>
                            <option value="siliconflow">SiliconFlow</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Êé•Âè£Âú∞ÂùÄ</label>
                        <input type="text" class="form-input" id="cfg-func-url" name="api-func-url" placeholder="https://api.example.com/v1" oninput="Settings.autoSave()" onchange="Settings.autoSave()">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ÂØÜÈí•</label>
                        <input type="password" class="form-input" id="cfg-func-key" name="api-func-key" placeholder="sk-..." oninput="Settings.autoSave()" onchange="Settings.autoSave()">
                    </div>
                </div>
                
                <!-- Ê®°ÂûãÂêçÁß∞Â≠óÊÆµÂßãÁªàÊòæÁ§∫Ôºå‰∏çÂèó"‰ΩøÁî®Áõ∏ÂêåÈÖçÁΩÆ"ÂΩ±Âìç -->
                <div class="form-group">
                    <label class="form-label">Ê®°ÂûãÂêçÁß∞</label>
                    <div class="button-group">
                        <div class="model-input-flex">
                            <input type="text" class="form-input" id="cfg-func-model" name="api-func-model" placeholder="gpt-3.5-turbo" oninput="Settings.filterModels('func'); Settings.autoSave();" onchange="Settings.autoSave()">
                            <div class="model-list" id="model-list-func"></div>
                        </div>
                        <button class="btn-scan" id="btn-scan-func" onclick="Settings.fetchModels('func')">Êâ´Êèè</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <button class="btn-test-api" id="btn-test-func" onclick="Settings.testAPI('func')">ÊµãËØïËøûÊé•</button>
                </div>
                </div>
            </div>
            
            <button class="btn-save-config" id="btnSaveConfig" onclick="Settings.handleSaveConfig()">‰øùÂ≠òÈÖçÁΩÆ</button>
        </div>
    </div>


    <!-- ËßíËâ≤‰ø°ÊÅØÂºïÂØºÈ°µÈù¢ -->
    <div id="characterIntroSection" class="hidden-section">
        <div class="vertical-line"></div>
        <div class="scroll-container">
            <div class="content-wrapper">
                <div class="system-beep">ÂèÆ‚Äî‚Äî</div>
                <div class="dialogue-text">
                    <p class="dialogue-paragraph" id="char-line1"></p>
                    <p class="dialogue-paragraph" id="char-line2"></p>
                    <p class="dialogue-paragraph" id="char-line3"></p>
                </div>
                <button class="continue-btn" id="continueBtnChar">ÁªßÁª≠ ‚Üí</button>
            </div>
        </div>
    </div>
    
    <!-- ËßíËâ≤ËÆæÂÆöÈ°µÈù¢ -->
    <div id="characterSetupSection">
        <div class="character-container">
            <h1 class="config-title">ËßíËâ≤ËÆæÂÆö</h1>
            
            <!-- ËßíËâ≤Ë°®ÂçïÔºàÊ†áÁ≠æÈ°µÁâàÊú¨Ôºâ -->
            <div id="character-form">
                <div class="character-tabs-wrapper">
                    <!-- Ê†áÁ≠æÈ°µÂØºËà™ -->
                    <div class="character-tabs-nav">
                        <button class="character-tab active" data-tab="basic" onclick="CharacterForm.switchTab('basic')">
                            <span class="character-tab-text">Âü∫Êú¨</span>
                        </button>
                        <button class="character-tab" data-tab="background" onclick="CharacterForm.switchTab('background'); WorldPreference.init();">
                            <span class="character-tab-text">ÂÅèÂ•Ω</span>
                        </button>
                    </div>
                    
                    <!-- Ê†áÁ≠æÈ°µÂÜÖÂÆπ -->
                    <div class="character-tabs-content">
                        <!-- Âü∫Êú¨‰ø°ÊÅØ -->
                        <div class="character-tab-panel active" data-panel="basic">
                            <div class="character-field">
                                <label class="character-field-label">ÂßìÂêç</label>
                                <input type="text" class="character-input-compact" id="char-name" name="character-name" placeholder="ËæìÂÖ•‰Ω†ÁöÑÂßìÂêç" oninput="CharacterManager.autoSave()">
                            </div>
                            <div class="character-field">
                                <label class="character-field-label">ÊÄßÂà´</label>
                                <div class="character-gender-inline">
                                    <label>
                                        <input type="radio" name="gender" value="female" checked onchange="CharacterManager.autoSave()">
                                        <span>Â•≥</span>
                                    </label>
                                </div>
                            </div>
                            <div class="character-field">
                                <label class="character-field-label">Â§ñË≤åÁâπÂæÅ</label>
                                <textarea class="character-textarea-compact character-textarea-short" id="char-appearance" name="character-appearance" placeholder="‰æãÂ¶ÇÔºöÁªùËâ≤ÂÆπË≤åÔºåÂá§Áú∏Âê´Â™öÔºåÂÜ∑Ëâ≥È´òË¥µ..." oninput="CharacterManager.autoSave()"></textarea>
                            </div>
                            <div class="character-field">
                                <label class="character-field-label">ÊÄßÊ†ºÂÄæÂêë</label>
                                <textarea class="character-textarea-compact character-textarea-short" id="char-personality" name="character-personality" placeholder="‰æãÂ¶ÇÔºöÊ∏©ÊüîÂñÑËâØ‰ΩÜÂÜÖÂøÉÂùöÂº∫ÔºåÂ§ñË°®ÂÜ∑ÈùôÂÆûÂàôÊÑüÊÄß..." oninput="CharacterManager.autoSave()"></textarea>
                            </div>
                        </div>
                        
                        <!-- ÂÅèÂ•Ω -->
                        <div class="character-tab-panel" data-panel="background">
                            <div class="character-field">
                                <!-- ÊéßÂà∂Ê†è -->
                                <div class="world-controls">
                                    <div class="world-controls-hint">ÈÄâ‰∏≠ = Â±èËîΩ</div>
                                    <div class="world-control-buttons">
                                        <button class="world-control-btn" onclick="WorldPreference.selectAll()">ÂÖ®ÈÄâ</button>
                                        <button class="world-control-btn" onclick="WorldPreference.clear()">Ê∏ÖÈô§</button>
                                    </div>
                                </div>
                                
                                <!-- Ê†áÁ≠æÂÆπÂô® -->
                                <div class="world-tags-container" id="worldTagsContainer">
                                    <!-- Ê†áÁ≠æÂ∞ÜÁî±JavaScriptÁîüÊàê -->
                                </div>
                            </div>
                            
                            <!-- Ëá™ÂÆö‰πâÈ¢òÊùêËæìÂÖ•Ê°Ü -->
                            <div class="character-field" style="margin-top: 20px;">
                                <label class="character-field-label">Ëá™ÂÆö‰πâÂñúÊ¨¢ÁöÑÈ¢òÊùê</label>
                                <input type="text" class="character-input-compact" id="customPreference" placeholder="Â°´ÂÜôÊ≠§È°πÂèØÂ¢ûÂä†ÁîüÊàê‰Ω†ÂñúÊ¨¢È¢òÊùêÁöÑÊ¶ÇÁéá" oninput="WorldPreference.saveCustom()">
                            </div>
                        </div>
                    </div>
                </div>    
                    
            </div>
            <button class="btn-start-journey" id="btnStartJourney" onclick="Character.startJourney()">Á°ÆËÆ§</button>                            
        </div>
    </div>

    <!-- ÂØºÂÖ•ËßíËâ≤ÂºπÁ™ó -->
    <div id="importModal" class="import-modal">
        <div class="import-modal-content">
            <h2 class="import-modal-title">ÂØºÂÖ•ËßíËâ≤</h2>
            <p class="import-modal-subtitle">ËØ∑Á≤òË¥¥ËßíËâ≤Êï∞ÊçÆ</p>
            
            <textarea class="import-textarea" id="importTextarea" placeholder="Â∞ÜËßíËâ≤Êï∞ÊçÆ‰ª£Á†ÅÁ≤òË¥¥Âà∞ËøôÈáå..."></textarea>
            
            <div class="import-modal-buttons">
                <button class="btn-import-cancel" onclick="ImportModal.close()">ÂèñÊ∂à</button>
                <button class="btn-import-confirm" onclick="ImportModal.confirm()">Á°ÆËÆ§ÂØºÂÖ• ‚Üí</button>
            </div>
        </div>
    </div>

    <!-- ÈáçÊñ∞ÈÖçÁΩÆAPIÊ®°ÊÄÅÊ°Ü -->

    <!-- Ê∏∏Êàè‰∏ªÁïåÈù¢ -->
    <div id="gameSection" class="game-section-hidden">
        <!-- È°∂ÈÉ®Ê†è -->
        <div class="game-header">
            <div class="game-title">OBSESSION</div>
            <div class="game-header-buttons">
                <button class="header-btn" onclick="GameUI.openPanel('settings')">
                    <span class="header-btn-text">ËÆæÁΩÆ</span>
                </button>
                <button class="header-btn" onclick="GameUI.openPanel('memory')">
                    <span class="header-btn-text">ËÆ∞ÂøÜ</span>
                </button>
                <button class="header-btn" onclick="GameUI.openPanel('saves')">
                    <span class="header-btn-text">Â≠òÊ°£</span>
                </button>
            </div>
        </div>

        <!-- ËÅäÂ§©Âå∫Âüü -->
        <div class="chat-container">
            <div class="chat-messages" id="chatMessages">
                <!-- Ê∂àÊÅØÂ∞ÜÂä®ÊÄÅÊ∑ªÂä†Âà∞ËøôÈáå -->
            </div>
        </div>

        <div class="input-container">
            <div class="input-wrapper">
                <textarea class="chat-input" id="chatInput" placeholder="ËæìÂÖ•‰Ω†ÁöÑË°åÂä®..." rows="1"></textarea>
                <button class="send-btn" id="sendBtn" onclick="GameUI.sendMessage()">
                    <span class="send-btn-text">SEND</span>
                </button>
            </div>
        </div>
        <!-- ËÆæÁΩÆÈù¢Êùø -->
        <div class="side-panel" id="settingsPanel">
            <div class="side-panel-overlay" onclick="GameUI.closePanel('settings')"></div>
            <div class="side-panel-content">
                <div class="side-panel-header">
                    <h2 class="side-panel-title">ËÆæÁΩÆ</h2>
                    <button class="side-panel-close" onclick="GameUI.closePanel('settings')">‚úï</button>
                </div>
                <div class="side-panel-body">

                    <!-- ËßíËâ≤ÁÆ°ÁêÜ -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">ËßíËâ≤ËÆæÂÆö</h3>
                        <div id="character-form-slot"></div>
                    </div>
                    
                    <!-- APIÈÖçÁΩÆÔºà‰ªéapiConfigSectionÁßªÂä®ËøáÊù•Ôºâ -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">APIÈÖçÁΩÆ</h3>
                        <div id="api-config-slot"></div>
                    </div>
                    
                    <!-- ËÆ∞ÂøÜÊÄªÁªìÈÖçÁΩÆ -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">ËÆ∞ÂøÜÊÄªÁªì</h3>
                        
                        <!-- ÂºÄÂêØËá™Âä®ÊÄªÁªì -->
                        <div class="memory-settings-container">
                            <label class="memory-settings-label">
                                <input type="checkbox" id="cfg-memory-auto" onchange="MemorySettings.save()" class="memory-settings-checkbox">
                                <span class="memory-settings-text">ÂºÄÂêØÈïøÊúüËÆ∞ÂøÜËá™Âä®ÊÄªÁªì</span>
                            </label>
                            <p class="memory-settings-hint">Áü≠ÊúüËÆ∞ÂøÜÊØèËΩÆÂØπËØùÈÉΩ‰ºöÁîüÊàêÔºåÈïøÊúüËÆ∞ÂøÜÊ†πÊçÆÈó¥ÈöîÂÆöÊúüÁîüÊàê</p>
                        </div>

                        <!-- ÊÄªÁªìÈó¥ÈöîËÆæÁΩÆ -->
                        <div class="memory-prompt-section">
                            <div class="memory-interval-grid">
                                <div>
                                    <label class="memory-interval-label">
                                        Ëá™Âä®ÊÄªÁªìÈó¥ÈöîÔºàËΩÆÔºâ
                                    </label>
                                    <input type="number" id="cfg-memory-interval" min="1" max="100" value="30" oninput="MemorySettings.save()" class="memory-interval-input">
                                </div>
                            </div>
                        </div>                      
                        
                        <!-- Áü≠ÊúüËÆ∞ÂøÜÊÄªÁªì -->
                        <div class="memory-prompt-section">
                            <div class="memory-prompt-header">
                                <label class="memory-prompt-label">Áü≠ÊúüËÆ∞ÂøÜÊÄªÁªìÊèêÁ§∫ËØç</label>
                                <div class="memory-prompt-buttons">
                                    <button class="icon-btn" onclick="MemorySettings.expandPrompt('short')" title="Â±ïÂºÄÁºñËæë">
                                        <span class="memory-prompt-icon">‚õ∂</span>
                                    </button>
                                    <button class="icon-btn" onclick="MemorySettings.resetShortPrompt()" title="ÈáçÁΩÆ‰∏∫ÈªòËÆ§ÊèêÁ§∫ËØç">
                                        <span class="memory-prompt-icon">‚Üª</span>
                                    </button>
                                </div>
                            </div>
                            <textarea id="cfg-memory-short-prompt" readonly onclick="MemorySettings.expandPrompt('short')" class="memory-prompt-textarea"></textarea>
                        </div>
                        
                        <!-- ÈïøÊúüËÆ∞ÂøÜÊÄªÁªì -->
                        <div class="memory-prompt-section">
                            <div class="memory-prompt-header">
                                <label class="memory-prompt-label">ÈïøÊúüËÆ∞ÂøÜÊÄªÁªìÊèêÁ§∫ËØç</label>
                                <div class="memory-prompt-buttons">
                                    <button class="icon-btn" onclick="MemorySettings.expandPrompt('long')" title="Â±ïÂºÄÁºñËæë">
                                        <span class="memory-prompt-icon">‚õ∂</span>
                                    </button>
                                    <button class="icon-btn" onclick="MemorySettings.resetLongPrompt()" title="ÈáçÁΩÆ‰∏∫ÈªòËÆ§ÊèêÁ§∫ËØç">
                                        <span class="memory-prompt-icon">‚Üª</span>
                                    </button>
                                </div>
                            </div>
                            <textarea id="cfg-memory-long-prompt" readonly onclick="MemorySettings.expandPrompt('long')" class="memory-prompt-textarea"></textarea>
                        </div>
                        
                    </div>
                    
                    <!-- ÊîØÊåÅ‰∏éÂèçÈ¶à -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">üìÆ ÂèçÈ¶àÂª∫ËÆÆ</h3>
                        
                        <div class="feedback-container">
                            <textarea 
                                id="feedbackContent" 
                                class="feedback-textarea"
                                placeholder="ÂëäËØâÊàë‰Ω†ÁöÑÊÉ≥Ê≥ï„ÄÅÂª∫ËÆÆ„ÄÅÈÅáÂà∞ÁöÑÈóÆÈ¢ò...&#10;&#10;Êàë‰ºöËÆ§ÁúüÁúãÊØè‰∏ÄÊù°ÂèçÈ¶àÔºÅ"
                            ></textarea>
                            
                            <input 
                                type="text" 
                                id="feedbackContact" 
                                class="feedback-contact"
                                placeholder="Áïô‰Ω†ÁöÑÈÇÆÁÆ±ÔºàÂèØÈÄâÔºâ"
                            >
                            
                            <button class="feedback-submit-btn" onclick="Support.sendFeedback()">
                                ÂèëÈÄÅÂèçÈ¶à
                            </button>
                            
                        </div>
                    </div>

                    <!-- Êï∞ÊçÆÁÆ°ÁêÜ -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">Êï∞ÊçÆÁÆ°ÁêÜ</h3>
                        <p class="data-manage-hint">ÂØºÂá∫ÂåÖÂê´ËßíËâ≤„ÄÅ‰∏ñÁïå„ÄÅÂØπËØù„ÄÅËÆ∞ÂøÜ„ÄÅÂ≠òÊ°£Á≠âÊâÄÊúâÊï∞ÊçÆ</p>
                        <div class="data-manage-buttons">
                            <button class="data-manage-btn" onclick="DataManager.exportCharacter()">
                                ÂØºÂá∫ËßíËâ≤
                            </button>
                            <button class="data-manage-btn" onclick="DataManager.importCharacter()">
                                ÂØºÂÖ•ËßíËâ≤
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- ËÆ∞ÂøÜÈù¢Êùø -->
        <div class="side-panel" id="memoryPanel">
            <div class="side-panel-overlay" onclick="GameUI.closePanel('memory')"></div>
            <div class="side-panel-content">
                <div class="side-panel-header">
                    <h2 class="side-panel-title">ËÆ∞ÂøÜ</h2>
                    <button class="side-panel-close" onclick="GameUI.closePanel('memory')">‚úï</button>
                </div>
                <div class="side-panel-body">
                    <div class="memory-section">
                        <h3 class="memory-section-title">Áü≠ÊúüËÆ∞ÂøÜ
                        <button class="memory-action-btn" id="btn-manual-long-term" onclick="MemoryManager.manualGenerateLongTerm()">
                            <span>ÊÄªÁªì</span>
                        </button>
                        </h3>
                        <div class="memory-list" id="shortTermMemory">
                            <p class="memory-empty">ÊöÇÊó†Áü≠ÊúüËÆ∞ÂøÜ</p>
                        </div>
                    </div>
                    <div class="memory-section">
                        <h3 class="memory-section-title">ÈïøÊúüËÆ∞ÂøÜ</h3>
                        <div class="memory-list" id="longTermMemory">
                            <p class="memory-empty">ÊöÇÊó†ÈïøÊúüËÆ∞ÂøÜ</p>
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>

        <!-- Â≠òÊ°£Èù¢Êùø -->
        <div class="side-panel" id="savesPanel">
            <div class="side-panel-overlay" onclick="GameUI.closePanel('saves')"></div>
            <div class="side-panel-content">
                <div class="side-panel-header">
                    <h2 class="side-panel-title">Â≠òÊ°£</h2>
                    <button class="side-panel-close" onclick="GameUI.closePanel('saves')">‚úï</button>
                </div>
                <div class="side-panel-body">
                    <div class="save-slots" id="saveSlots">
                        <!-- Â≠òÊ°£ÊßΩÂ∞ÜÂä®ÊÄÅÁîüÊàê -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Âè≥ÈîÆËèúÂçï -->
        <div class="context-menu" id="contextMenu">
            <!-- ËèúÂçïÈ°πÂ∞ÜÂä®ÊÄÅÁîüÊàê -->
        </div>
    </div>

    </div>


    <script src="script.js"></script>
<script>
const _sp='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';
document.getElementById('cfg-memory-short-prompt').value=_d(_sp);</script>
<script>const _lp='U2FsdGVkX18CezAakEuUVvJ1H7naWBpVMCH1ZymsFsAhK0kcwFiICgw1SkQXbtYjB5OIQaEhmJXMTZz40Y5bPLBZfw+589MmhGXsHkWtGNX0kIhnaWtlfyTdig/QOAxTvpoyJKsIt7cTprfUDRJSoCScasKWoVLIILYH7U8oJBkj159CCd5FfxBgNOOt0qSyj3de9p6A75Jis6N+sWNQrz0EtG+lO/17Dim8+sLmcecURDjlVbb+i5mabAA4dJLdNjTQl3Rz29wUxVw9I42TmLEX+eCrp/T3rg8FiKlRPJhes0EMXlTDqU4fppVLkwYhF0OBP0IHoncdVSid2QYmSyZpGJmoG+LVjcY+zDEyU1CGNJzljWafseEX0W2vNeX289MTOVtlKE3GKEXuXhKjxFktHTkuiVoDUOMdzgHQFC3ME7fYOvxgy3DkudwyX6r2SnNYVgVrKQE6qQ+uF7D3OBT/Z9vxS414URjSOWmDNJFlvi+hKY+of0xcR06uJtxtdv1NaO3KTzk4rkfdECErOg69Iy60p614XjtCoNc2LmN6FAYYUxlaIiscf7p5RuvTc2FwTSzVLxUb3ENK3MRwEVuRh9cvknubRx4mpGL9SOyKYUeN9Kg0TvNzYY9ZYuBtsQYHT/3/t7mg+p98errmX/AKAtsbuPEkEvRPrwDiYdaBasDjizyrHCF5Vj+5AKeV5hQIAOGTIcBRltrCgPv8QhpiDv1rLBdVRO13P3V54is0pu/7ZQAtBiaF+J/tEIB4upHXaI5DoVS8srrKsZ8os95vBYj6H722/mky4Zml0ZfOE3rBXp48kk2G7LJlY7rXYI6a7XFqe2dpDmd+zGm0+1ySaLYHCgPuPuZqbJTzOmwePljO3QpcVmPumo1dgLIIoCAlBrkVT02wNzsvrm93SaQ41Jifm6NESzSoeELHtFsUJb2ZVsb9+bCUeH/AYIRbRdTnTPxrbOjubXV7s78pymDNnht3OKZhLQ18ZekLmA3ocxEB3KvWqYY5SE4cOeitsDZxKhnMIvIjy6FqN6S46pX9KDCLIttgTvELVJLUfLsJXiPl42yGu+O7Ao0OBcT8cQsDvYapY/BW6KSBeFcSxC0egcWjtADZLrMLgEzQA2Qvz9sThE20G+YsHC+xhGkXSL9U1yi31fbw3PGE+AYyZoPoBG8NCpcBreqesrCr9K6mKWalqQ6VN0CV/11h789I5nclQZ1tl08PcujbcKdd1P6pKdM8d8zck/E83FUj+XiFj0dykqtJ5MWXsd+jS54y2FnCg++1pFFO/xeWYpvje5ofl8gYdjcueKz3jIcGazMSE3avKM0RpPHMkKEXcXu42GJdcCm1m31fFkbPibYKXtUNnV29y0doSXwzbS4RFP04kvro2NMCR4qwPFHp5Wq6E6yYbIBYCDyFR5nScBq8ECWURA/YEqF1SofdA4B6qjFFlJ2LML7qKk2DkwNUOeRRwCCTxjGOehVXh8f3NiJzfA==';
document.getElementById('cfg-memory-long-prompt').value=_d(_lp);</script>
</body>
</html>
