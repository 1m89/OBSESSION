<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OBSESSION</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;600;900&family=Cinzel:wght@400;600;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
<script>
function _d(e){try{return CryptoJS.AES.decrypt(e,'OBS3SS10N_mlplsk20').toString(CryptoJS.enc.Utf8)}catch(t){return''}}
</script>
</head>
<body>
    <!-- 自定义提示框 -->
    <div id="customAlert" class="custom-alert">
        <div class="custom-alert-content">
            <div class="custom-alert-message" id="alertMessage"></div>
            <button class="custom-alert-button" onclick="Alert.close()">确定</button>
        </div>
    </div>

    <!-- 自定义确认框 -->
    <div id="customConfirm" class="custom-alert">
        <div class="custom-alert-content">
            <div class="custom-alert-message" id="confirmMessage"></div>
            <div class="confirm-buttons">
                <button class="confirm-button-cancel" onclick="Confirm.cancel()">取消</button>
                <button class="confirm-button-ok" onclick="Confirm.ok()">确定</button>
            </div>
        </div>
    </div>
    
    <!-- 提示词编辑弹窗 -->
    <div id="promptEditModal" class="prompt-edit-modal">
        <div class="prompt-edit-overlay" onclick="MemorySettings.closePromptEdit()"></div>
        <div class="prompt-edit-content">
            <div class="prompt-edit-header">
                <h3 id="promptEditTitle" class="prompt-edit-title">编辑提示词</h3>
                <button class="side-panel-close" onclick="MemorySettings.closePromptEdit()">✕</button>
            </div>
            <div class="prompt-edit-body">
                <textarea id="promptEditTextarea" class="prompt-edit-textarea" placeholder="请输入提示词..."></textarea>
            </div>
            <div class="prompt-edit-footer">
                <button class="confirm-button-cancel" onclick="MemorySettings.closePromptEdit()">取消</button>
                <button class="confirm-button-ok" onclick="MemorySettings.savePromptEdit()">保存</button>
            </div>
        </div>
    </div>

    <!-- 左上角锐利装饰元素 -->
    <div class="corner-accent"></div>
    
    <!-- 装饰元素 -->
    <div class="decorations">
        <div class="corner corner-tl"></div>
        <div class="corner corner-tr"></div>
        <div class="corner corner-bl"></div>
        <div class="corner corner-br"></div>
    </div>

    <!-- 主容器 -->
    <div class="container">
        <div class="title-section">
            <h1 class="title-main">OBSESSION</h1>
            <p class="title-sub">世界万千，一念所向</p>
            <div class="accent-line">
                <div class="accent-dot"></div>
            </div>
        </div>

        <div class="actions">
            <button class="btn btn-primary" id="newCharacter">
                <span class="btn-text">
                    <span class="btn-text__cn">新建角色</span>
                    <span class="btn-text__en">New Character</span>
                </span>
                <span class="btn-icon">→</span>
            </button>

            <button class="btn btn-secondary" id="importCharacter">
                <span class="btn-text">
                    <span class="btn-text__cn">导入角色</span>
                    <span class="btn-text__en">Import Character</span>
                </span>
                <span class="btn-icon">↑</span>
            </button>
        </div>
    </div>

    <div class="footer-hint">- Local Storage -</div>

    <!-- 系统绑定引导页内容 -->
    <div id="bindingSection" class="hidden-section">
        <!-- 左侧竖线 - 独立固定 -->
        <div class="vertical-line"></div>
        
        <!-- 滚动容器 -->
        <div class="scroll-container">
            <div class="content-wrapper">
                <div class="system-beep">叮——</div>
                
                <div class="dialogue-text">
                    <p class="dialogue-paragraph" id="line1"></p>
                    <p class="dialogue-paragraph" id="line2"></p>
                    <p class="dialogue-paragraph" id="line3"></p>
                    <p class="dialogue-paragraph" id="line4"></p>
                    <p class="dialogue-paragraph" id="line5"></p>
                    <p class="dialogue-paragraph" id="line6"></p>
                    <p class="dialogue-paragraph" id="line7"></p>
                    <p class="dialogue-paragraph" id="line8"></p>
                </div>

                <button class="continue-btn" id="continueBtn">
                    <span class="continue-btn-text">进入配置 →</span>
                </button>
            </div>
        </div>
    </div>

    <!-- API配置页面 -->
    <div id="apiConfigSection">
        <div class="config-container">
            <h1 class="config-title">系统配置</h1>
            
            <!-- API配置表单（可移动到设置面板） -->
            <div id="api-config-form">
                <!-- 对话模型配置 -->
                <div class="model-config-block">
                    <h4 class="block-title">对话模型</h4>
                
                <div class="form-group">
                    <label class="form-label">服务商</label>
                    <div class="custom-select-wrapper">
                        <div class="custom-select" data-select="cfg-provider">
                            <span class="custom-select-value">自定义</span>
                            <svg class="custom-select-arrow" viewBox="0 0 12 8" fill="none">
                                <path d="M1 1L6 6L11 1" stroke="#d4879c" stroke-width="2"/>
                            </svg>
                        </div>
                        <div class="custom-select-dropdown">
                            <div class="custom-select-option selected" data-value="custom">自定义</div>
                            <div class="custom-select-option" data-value="openai">OpenAI</div>
                            <div class="custom-select-option" data-value="openrouter">Open Router</div>
                            <div class="custom-select-option" data-value="gemini">Google AI Studio</div>
                            <div class="custom-select-option" data-value="deepseek">DeepSeek</div>
                            <div class="custom-select-option" data-value="siliconflow">SiliconFlow</div>
                        </div>
                    </div>
                    <!-- 隐藏的原生select，用于保存值 -->
                    <select class="form-select" id="cfg-provider" onchange="Settings.onProviderChange('chat')" style="display: none;">
                        <option value="custom">自定义</option>
                        <option value="openai">OpenAI</option>
                        <option value="openrouter">Open Router</option>
                        <option value="gemini">Google AI Studio</option>
                        <option value="deepseek">DeepSeek</option>
                        <option value="siliconflow">SiliconFlow</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">接口地址</label>
                    <input type="text" class="form-input" id="cfg-url" name="api-chat-url" placeholder="https://api.example.com/v1" oninput="Settings.autoSave()" onchange="Settings.autoSave()">
                </div>
                
                <div class="form-group">
                    <label class="form-label">密钥</label>
                    <input type="password" class="form-input" id="cfg-key" name="api-chat-key" placeholder="sk-..." oninput="Settings.autoSave()" onchange="Settings.autoSave()">
                </div>
                
                <div class="form-group">
                    <label class="form-label">模型名称</label>
                    <div class="button-group">
                        <div class="model-input-flex">
                            <input type="text" class="form-input" id="cfg-model" name="api-chat-model" placeholder="gpt-4" oninput="Settings.filterModels('chat'); Settings.autoSave();" onchange="Settings.autoSave()">
                            <div class="model-list" id="model-list-chat"></div>
                        </div>
                        <button class="btn-scan" id="btn-scan-chat" onclick="Settings.fetchModels('chat')">扫描</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <button class="btn-test-api" id="btn-test-chat" onclick="Settings.testAPI('chat')">测试连接</button>
                </div>
            </div>
            
            <!-- 记忆模型配置 -->
            <div class="model-config-block">
                <h4 class="block-title">记忆模型</h4>
                
                <label class="checkbox-group">
                    <input type="checkbox" checked id="cfg-func-same" onchange="Settings.toggleFuncExtra()">
                    <span class="checkbox-label">使用相同配置</span>
                </label>
                
                <div id="func-extra" class="func-extra-hidden">
                    <div class="form-group">
                        <label class="form-label">服务商</label>
                        <div class="custom-select-wrapper">
                            <div class="custom-select" data-select="cfg-func-provider">
                                <span class="custom-select-value">自定义</span>
                                <svg class="custom-select-arrow" viewBox="0 0 12 8" fill="none">
                                    <path d="M1 1L6 6L11 1" stroke="#d4879c" stroke-width="2"/>
                                </svg>
                            </div>
                            <div class="custom-select-dropdown">
                                <div class="custom-select-option selected" data-value="custom">自定义</div>
                                <div class="custom-select-option" data-value="openai">OpenAI</div>
                                <div class="custom-select-option" data-value="openrouter">Open Router</div>
                                <div class="custom-select-option" data-value="gemini">Google AI Studio</div>
                                <div class="custom-select-option" data-value="deepseek">DeepSeek</div>
                                <div class="custom-select-option" data-value="siliconflow">SiliconFlow</div>
                            </div>
                        </div>
                        <!-- 隐藏的原生select，用于保存值 -->
                        <select class="form-select" id="cfg-func-provider" onchange="Settings.onProviderChange('func')" style="display: none;">
                            <option value="custom">自定义</option>
                            <option value="openai">OpenAI</option>
                            <option value="openrouter">Open Router</option>
                            <option value="gemini">Google AI Studio</option>
                            <option value="deepseek">DeepSeek</option>
                            <option value="siliconflow">SiliconFlow</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">接口地址</label>
                        <input type="text" class="form-input" id="cfg-func-url" name="api-func-url" placeholder="https://api.example.com/v1" oninput="Settings.autoSave()" onchange="Settings.autoSave()">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">密钥</label>
                        <input type="password" class="form-input" id="cfg-func-key" name="api-func-key" placeholder="sk-..." oninput="Settings.autoSave()" onchange="Settings.autoSave()">
                    </div>
                </div>
                
                <!-- 模型名称字段始终显示，不受"使用相同配置"影响 -->
                <div class="form-group">
                    <label class="form-label">模型名称</label>
                    <div class="button-group">
                        <div class="model-input-flex">
                            <input type="text" class="form-input" id="cfg-func-model" name="api-func-model" placeholder="gpt-3.5-turbo" oninput="Settings.filterModels('func'); Settings.autoSave();" onchange="Settings.autoSave()">
                            <div class="model-list" id="model-list-func"></div>
                        </div>
                        <button class="btn-scan" id="btn-scan-func" onclick="Settings.fetchModels('func')">扫描</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <button class="btn-test-api" id="btn-test-func" onclick="Settings.testAPI('func')">测试连接</button>
                </div>
                </div>
            </div>
            
            <button class="btn-save-config" id="btnSaveConfig" onclick="Settings.handleSaveConfig()">保存配置</button>
        </div>
    </div>


    <!-- 角色信息引导页面 -->
    <div id="characterIntroSection" class="hidden-section">
        <div class="vertical-line"></div>
        <div class="scroll-container">
            <div class="content-wrapper">
                <div class="system-beep">叮——</div>
                <div class="dialogue-text">
                    <p class="dialogue-paragraph" id="char-line1"></p>
                    <p class="dialogue-paragraph" id="char-line2"></p>
                    <p class="dialogue-paragraph" id="char-line3"></p>
                </div>
                <button class="continue-btn" id="continueBtnChar">继续 →</button>
            </div>
        </div>
    </div>
    
    <!-- 角色设定页面 -->
    <div id="characterSetupSection">
        <div class="character-container">
            <h1 class="config-title">角色设定</h1>
            
            <!-- 角色表单（标签页版本） -->
            <div id="character-form">
                <div class="character-tabs-wrapper">
                    <!-- 标签页导航 -->
                    <div class="character-tabs-nav">
                        <button class="character-tab active" data-tab="basic" onclick="CharacterForm.switchTab('basic')">
                            <span class="character-tab-text">基本</span>
                        </button>
                        <button class="character-tab" data-tab="background" onclick="CharacterForm.switchTab('background'); WorldPreference.init();">
                            <span class="character-tab-text">偏好</span>
                        </button>
                    </div>
                    
                    <!-- 标签页内容 -->
                    <div class="character-tabs-content">
                        <!-- 基本信息 -->
                        <div class="character-tab-panel active" data-panel="basic">
                            <div class="character-field">
                                <label class="character-field-label">姓名</label>
                                <input type="text" class="character-input-compact" id="char-name" name="character-name" placeholder="输入你的姓名" oninput="CharacterManager.autoSave()">
                            </div>
                            <div class="character-field">
                                <label class="character-field-label">性别</label>
                                <div class="character-gender-inline">
                                    <label>
                                        <input type="radio" name="gender" value="female" checked onchange="CharacterManager.autoSave()">
                                        <span>女</span>
                                    </label>
                                </div>
                            </div>
                            <div class="character-field">
                                <label class="character-field-label">外貌特征</label>
                                <textarea class="character-textarea-compact character-textarea-short" id="char-appearance" name="character-appearance" placeholder="例如：绝色容貌，凤眸含媚，冷艳高贵..." oninput="CharacterManager.autoSave()"></textarea>
                            </div>
                            <div class="character-field">
                                <label class="character-field-label">性格倾向</label>
                                <textarea class="character-textarea-compact character-textarea-short" id="char-personality" name="character-personality" placeholder="例如：温柔善良但内心坚强，外表冷静实则感性..." oninput="CharacterManager.autoSave()"></textarea>
                            </div>
                        </div>
                        
                        <!-- 偏好 -->
                        <div class="character-tab-panel" data-panel="background">
                            <div class="character-field">
                                <!-- 控制栏 -->
                                <div class="world-controls">
                                    <div class="world-controls-hint">选中 = 屏蔽</div>
                                    <div class="world-control-buttons">
                                        <button class="world-control-btn" onclick="WorldPreference.selectAll()">全选</button>
                                        <button class="world-control-btn" onclick="WorldPreference.clear()">清除</button>
                                    </div>
                                </div>
                                
                                <!-- 标签容器 -->
                                <div class="world-tags-container" id="worldTagsContainer">
                                    <!-- 标签将由JavaScript生成 -->
                                </div>
                                
                                <!-- 自定义题材输入框 -->
                                <div class="character-field" style="margin-top: 20px;">
                                    <label class="character-field-label">自定义喜欢的题材</label>
                                    <input type="text" class="character-input-compact" id="customPreference" placeholder="填写此项可增加生成你喜欢题材的概率" oninput="WorldPreference.saveCustom()">
                                    </div>
                                </div>
                                <button class="btn-start-journey" id="btnStartJourney" onclick="Character.startJourney()">确认</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
    </div>

    <!-- 导入角色弹窗 -->
    <div id="importModal" class="import-modal">
        <div class="import-modal-content">
            <h2 class="import-modal-title">导入角色</h2>
            <p class="import-modal-subtitle">请粘贴角色数据</p>
            
            <textarea class="import-textarea" id="importTextarea" placeholder="将角色数据代码粘贴到这里..."></textarea>
            
            <div class="import-modal-buttons">
                <button class="btn-import-cancel" onclick="ImportModal.close()">取消</button>
                <button class="btn-import-confirm" onclick="ImportModal.confirm()">确认导入 →</button>
            </div>
        </div>
    </div>

    <!-- 重新配置API模态框 -->

    <!-- 游戏主界面 -->
    <div id="gameSection" class="game-section-hidden">
        <!-- 顶部栏 -->
        <div class="game-header">
            <div class="game-title">OBSESSION</div>
            <div class="game-header-buttons">
                <button class="header-btn" onclick="GameUI.openPanel('settings')">
                    <span class="header-btn-text">设置</span>
                </button>
                <button class="header-btn" onclick="GameUI.openPanel('memory')">
                    <span class="header-btn-text">记忆</span>
                </button>
                <button class="header-btn" onclick="GameUI.openPanel('saves')">
                    <span class="header-btn-text">存档</span>
                </button>
            </div>
        </div>

        <!-- 聊天区域 -->
        <div class="chat-container">
            <div class="chat-messages" id="chatMessages">
                <!-- 消息将动态添加到这里 -->
            </div>
        </div>

        <div class="input-container">
            <div class="input-wrapper">
                <textarea class="chat-input" id="chatInput" placeholder="输入你的行动..." rows="1"></textarea>
                <button class="send-btn" id="sendBtn" onclick="GameUI.sendMessage()">
                    <span class="send-btn-text">SEND</span>
                </button>
            </div>
        </div>
        <!-- 设置面板 -->
        <div class="side-panel" id="settingsPanel">
            <div class="side-panel-overlay" onclick="GameUI.closePanel('settings')"></div>
            <div class="side-panel-content">
                <div class="side-panel-header">
                    <h2 class="side-panel-title">设置</h2>
                    <button class="side-panel-close" onclick="GameUI.closePanel('settings')">✕</button>
                </div>
                <div class="side-panel-body">

                    <!-- 角色管理 -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">角色设定</h3>
                        <div id="character-form-slot"></div>
                    </div>
                    
                    <!-- API配置（从apiConfigSection移动过来） -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">API配置</h3>
                        <div id="api-config-slot"></div>
                    </div>
                    
                    <!-- 记忆总结配置 -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">记忆总结</h3>
                        
                        <!-- 开启自动总结 -->
                        <div class="memory-settings-container">
                            <label class="memory-settings-label">
                                <input type="checkbox" id="cfg-memory-auto" onchange="MemorySettings.save()" class="memory-settings-checkbox">
                                <span class="memory-settings-text">开启长期记忆自动总结</span>
                            </label>
                            <p class="memory-settings-hint">短期记忆每轮对话都会生成，长期记忆根据间隔定期生成</p>
                        </div>

                        <!-- 总结间隔设置 -->
                        <div class="memory-prompt-section">
                            <div class="memory-interval-grid">
                                <div>
                                    <label class="memory-interval-label">
                                        自动总结间隔（轮）
                                    </label>
                                    <input type="number" id="cfg-memory-interval" min="1" max="100" value="30" oninput="MemorySettings.save()" class="memory-interval-input">
                                </div>
                            </div>
                        </div>                      
                        
                        <!-- 短期记忆总结 -->
                        <div class="memory-prompt-section">
                            <div class="memory-prompt-header">
                                <label class="memory-prompt-label">短期记忆总结提示词</label>
                                <div class="memory-prompt-buttons">
                                    <button class="icon-btn" onclick="MemorySettings.expandPrompt('short')" title="展开编辑">
                                        <span class="memory-prompt-icon">⛶</span>
                                    </button>
                                    <button class="icon-btn" onclick="MemorySettings.resetShortPrompt()" title="重置为默认提示词">
                                        <span class="memory-prompt-icon">↻</span>
                                    </button>
                                </div>
                            </div>
                            <textarea id="cfg-memory-short-prompt" readonly onclick="MemorySettings.expandPrompt('short')" class="qyjb"></textarea>
                        </div>
                        
                        <!-- 长期记忆总结 -->
                        <div class="memory-prompt-section">
                            <div class="memory-prompt-header">
                                <label class="memory-prompt-label">长期记忆总结提示词</label>
                                <div class="memory-prompt-buttons">
                                    <button class="icon-btn" onclick="MemorySettings.expandPrompt('long')" title="展开编辑">
                                        <span class="memory-prompt-icon">⛶</span>
                                    </button>
                                    <button class="icon-btn" onclick="MemorySettings.resetLongPrompt()" title="重置为默认提示词">
                                        <span class="memory-prompt-icon">↻</span>
                                    </button>
                                </div>
                            </div>
                            <textarea id="cfg-memory-long-prompt" readonly onclick="MemorySettings.expandPrompt('long')" class="qyjb"></textarea>
                        </div>
                        
                    </div>
                    
                    <!-- 支持与反馈 -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">📮 反馈建议</h3>
                        
                        <div class="feedback-container">
                            <textarea 
                                id="feedbackContent" 
                                class="feedback-textarea"
                                placeholder="告诉我你的想法、建议、遇到的问题...&#10;&#10;我会认真看每一条反馈！"
                            ></textarea>
                            
                            <input 
                                type="text" 
                                id="feedbackContact" 
                                class="feedback-contact"
                                placeholder="留你的邮箱（可选）"
                            >
                            
                            <button class="feedback-submit-btn" onclick="Support.sendFeedback()">
                                发送反馈
                            </button>
                            
                        </div>
                    </div>

                    <!-- 数据管理 -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">数据管理</h3>
                        <p class="data-manage-hint">导出包含角色、世界、对话、记忆、存档等所有数据</p>
                        <div class="data-manage-buttons">
                            <button class="data-manage-btn" onclick="DataManager.exportCharacter()">
                                导出角色
                            </button>
                            <button class="data-manage-btn" onclick="DataManager.importCharacter()">
                                导入角色
                            </button>
                        </div>
                    </div>

                    <!-- 关于 - 暂时隐藏 -->
                    <!-- <div class="settings-section">
                        <h3 class="settings-section-title">关于</h3>
                        
                        <div class="about-container">
                            <div class="about-logo">
                                <h2 class="about-title">OBSESSION</h2>
                            </div>
                            
                            <div class="about-info">
                                 <div class="about-item">
                                    <span class="about-label">版本</span>
                                    <span class="about-value">v1.0.0</span>
                                </div> -->
                                <!-- <div class="about-item">
                                    <span class="about-label">开发者</span>
                                    <span class="about-value">C.0</span>
                                </div>
                                <div class="about-item">
                                    <span class="about-label">小红书</span>
                                    <span class="about-value">@C.0</span>
                                </div> -->
                            </div>
                                                        
                            <!-- <div class="about-actions">
                                <button class="about-btn" onclick="About.showTerms()">
                                    用户协议
                                </button>
                                <button class="about-btn" onclick="About.showPrivacy()">
                                    隐私说明
                                </button>
                            </div> 
                        </div>
                    </div> -->
                </div>
            </div>
        </div>

        <!-- 记忆面板 -->
        <div class="side-panel" id="memoryPanel">
            <div class="side-panel-overlay" onclick="GameUI.closePanel('memory')"></div>
            <div class="side-panel-content">
                <div class="side-panel-header">
                    <h2 class="side-panel-title">记忆</h2>
                    <button class="side-panel-close" onclick="GameUI.closePanel('memory')">✕</button>
                </div>
                <div class="side-panel-body">
                    <div class="memory-section">
                        <h3 class="memory-section-title">短期记忆
                        <button class="memory-action-btn" id="btn-manual-long-term" onclick="MemoryManager.manualGenerateLongTerm()">
                            <span>总结</span>
                        </button>
                        </h3>
                        <div class="memory-list" id="shortTermMemory">
                            <p class="memory-empty">暂无短期记忆</p>
                        </div>
                    </div>
                    <div class="memory-section">
                        <h3 class="memory-section-title">长期记忆</h3>
                        <div class="memory-list" id="longTermMemory">
                            <p class="memory-empty">暂无长期记忆</p>
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>

        <!-- 存档面板 -->
        <div class="side-panel" id="savesPanel">
            <div class="side-panel-overlay" onclick="GameUI.closePanel('saves')"></div>
            <div class="side-panel-content">
                <div class="side-panel-header">
                    <h2 class="side-panel-title">存档</h2>
                    <button class="side-panel-close" onclick="GameUI.closePanel('saves')">✕</button>
                </div>
                <div class="side-panel-body">
                    <div class="save-slots" id="saveSlots">
                        <!-- 存档槽将动态生成 -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 右键菜单 -->
        <div class="context-menu" id="contextMenu">
            <!-- 菜单项将动态生成 -->
        </div>
    </div>

<!-- 用户协议弹窗 - 暂时隐藏 -->
    <!-- <div id="termsModal" class="terms-modal">
            <div class="terms-overlay"></div>
            <div class="terms-content">
                <div class="terms-header">
                    <h2 class="terms-title">欢迎使用 OBSESSION</h2>
                    <button class="side-panel-close" onclick="About.closeTerms()" id="termsCloseBtn" style="display: none;">✕</button>
                </div>
                <div class="terms-body" id="termsBody">
                    <p class="intro-text">
                        在使用前，请仔细阅读以下使用协议和隐私说明。<br>
                        <strong style="color: var(--blood-red);">滚动阅读到底部即可关闭，继续使用即表示您同意本协议。</strong>
                    </p>

                    <div class="terms-section">
                        <h3>1. 产品说明</h3>
                        <p>OBSESSION 是一款基于快穿世界观的AI互动叙事工具，供个人娱乐使用。</p>
                        <ul>
                            <li>本工具不提供AI服务，需用户自行配置API密钥</li>
                            <li>所有数据存储在用户本地浏览器中</li>
                            <li>开发者不收集、不存储、不上传任何用户数据</li>
                        </ul>
                    </div>

                    <div class="terms-section">
                        <h3>2. 用户责任</h3>
                        <p>使用本工具即表示您同意：</p>
                        <ul>
                            <li>您对使用本工具生成的所有内容承担全部责任</li>
                            <li>您不会将本工具用于任何违法、侵权或不当用途</li>
                            <li>您理解AI生成的内容可能存在偏差、错误或不适宜的情况</li>
                            <li>您使用的API密钥及产生的费用由您自行负责</li>
                        </ul>
                    </div>

                    <div class="terms-section">
                        <h3>3. 隐私保护</h3>
                        <p>OBSESSION 高度重视您的隐私：</p>
                        <ul class="check-list">
                            <li>✓ 所有角色、对话、记忆数据存储在您的浏览器本地</li>
                            <li>✓ 不收集任何个人信息或使用行为</li>
                            <li>✓ 不使用第三方数据分析工具</li>
                            <li>✓ 您的API密钥直接从浏览器发送到AI服务商</li>
                        </ul>
                        <p class="warning">⚠️ 请注意：清除浏览器数据会导致本地数据丢失，请及时导出备份</p>
                    </div>

                    <div class="terms-section">
                        <h3>4. 免责声明</h3>
                        <ul>
                            <li>本工具仍在持续开发中，可能存在功能不完善或偶发错误</li>
                            <li>开发者会尽力优化，但不对使用过程中的任何问题承担责任</li>
                            <li>开发者不对因使用本工具导致的任何损失承担责任</li>
                            <li>开发者保留随时修改、暂停或终止服务的权利</li>
                        </ul>
                    </div>

                    <div class="terms-section">
                        <h3>5. 知识产权</h3>
                        <ul>
                            <li>本产品的代码、UI设计、世界观设定、提示词框架等归开发者所有</li>
                            <li>允许个人学习研究，禁止商业使用和二次分发</li>
                            <li>禁止删除版权标识后传播或用于其他项目</li>
                            <li>用户生成的内容版权归用户本人</li>
                        </ul>
                    </div>

                    <div class="terms-section">
                        <h3>6. 其他</h3>
                        <p>如有疑问或建议，欢迎通过产品内反馈功能联系开发者。</p>
                    </div>

                    <div class="terms-footer">
                        <p>开发者：C.0</p>
                        <p>小红书：@C.0</p>
                        <p>最后更新：2026年2月</p>
                    </div>
                </div>
            </div>
        </div> -->

        <!-- 隐私说明弹窗 - 暂时隐藏 -->
        <!-- <div id="privacyModal" class="terms-modal">
            <div class="terms-overlay" onclick="About.closePrivacy()"></div>
            <div class="terms-content">
                <div class="terms-header">
                    <h2 class="terms-title">隐私说明</h2>
                    <button class="side-panel-close" onclick="About.closePrivacy()">✕</button>
                </div>
                <div class="terms-body">
                    <p class="intro-text">OBSESSION 采用完全本地化的设计理念，最大程度保护您的隐私。</p>

                    <div class="terms-section">
                        <h3>我们做的</h3>
                        <ul class="check-list">
                            <li>✓ <strong>本地存储</strong> - 所有数据存储在您的浏览器本地，不经过任何服务器</li>
                            <li>✓ <strong>零追踪</strong> - 不使用任何数据分析、用户追踪或统计工具</li>
                            <li>✓ <strong>零收集</strong> - 不收集您的个人信息、使用习惯或生成内容</li>
                            <li>✓ <strong>开放透明</strong> - 代码逻辑公开透明，可随时审查</li>
                        </ul>
                    </div>

                    <div class="terms-section">
                        <h3>我们不做的</h3>
                        <ul class="cross-list">
                            <li>✗ 不在服务器存储任何用户数据</li>
                            <li>✗ 不使用Cookie进行用户追踪</li>
                            <li>✗ 不与任何第三方共享您的信息</li>
                            <li>✗ 不访问或上传您的对话内容</li>
                        </ul>
                    </div>

                    <div class="terms-section">
                        <h3>数据流向</h3>
                        <ol>
                            <li><strong>API密钥</strong> - 您配置的密钥仅存储在本地浏览器，发送API请求时直接从您的浏览器发往对应的AI服务商</li>
                            <li><strong>对话内容</strong> - 您与AI的对话内容仅在您的浏览器和AI服务商之间传输，本工具不作任何中转或存储</li>
                            <li><strong>角色数据</strong> - 所有角色设定、记忆、存档等数据均存储在浏览器的localStorage中</li>
                        </ol>
                    </div>

                    <div class="terms-section">
                        <h3>您的权利</h3>
                        <ul>
                            <li>您可以随时通过浏览器设置清除所有本地数据</li>
                            <li>您可以使用导出功能备份数据到本地文件</li>
                            <li>您对自己生成的所有内容拥有完整控制权</li>
                        </ul>
                    </div>

                    <div class="terms-section">
                        <h3>重要提醒</h3>
                        <p class="warning">⚠️ 清除浏览器数据、缓存或使用隐私模式会导致本地数据丢失</p>
                        <p class="warning">⚠️ 定期使用"导出角色"功能备份重要数据</p>
                        <p class="warning">⚠️ 切换浏览器或设备需要手动导入数据</p>
                    </div>

                    <div class="terms-footer">
                        <p><strong>您的数据，完全属于您。</strong></p>
                    </div>
                </div>
            </div>
        </div> 
    </div>-->


    <script src="script.js"></script>
<script>
const _sp='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';
document.getElementById('cfg-memory-short-prompt').value=_d(_sp);</script>
<script>const _lp='U2FsdGVkX1/2Iffsn/BA9N3yv5GprO3PH9inJKDhAI7BOaTT8vHcX+YZdJn5/NmQU9fD0VL9/bCGAIPVaTTUySagNlZFd39yXXwFs6/M2/9q0JqtTpDysGBh1ye0AMiJjMy/4BXdUtVHHywy4xw13+swuNE+GSR5ZCVwe7Ab3ODwfVXglMmyt/RnFInEt7bE5tYB2vs0K32cd8OfplVm/SvzNHihl+IVYghJn5sOiRVouIc1cnpxVL/a+t5h29Gp12MWg72a1QIezDtjUNNZmc9iUJzlfLa4xPLXB/w3J3dYHQCn8G6SJ5gdwxsyygHVlbJOeQ4BpLMv/Bf8MutWiKKCbORKl89THYGj1DtgO0eK3f691nBxsIGOzqPEU0wP+DBj1HEmbFOlWyAiD6CJbeECUypPdf16tTslibP56bLzJMEM45hnsPA8o+KOp+Nvj4xt6u17q1RGeQIQga1oH8epxqUB1MMXXwLk5lP0HL7HiR6Z0rpmhEsOiAdx3W9E1e2Dna+9mJ0p8VC81jtr/lph43KWykJBlw8agQwWCMd9eFb0y7OqL2gAxsVyJFNGQSBU5azGvfk0CVLT5uqNG3nX7onisTX8QubzvtYhsWFMQJM/qoVgKnXWY0rj5Fkp14d3VZ6AkJUYpaJQkhkzgDRSbjZAvh8Tcwlghiav03jV83glU8xpmLksBWbifk62OrqArwXod4ysgzG7WGHZrHQoL5/M8UVRnhZPoBVLIdWorsjzc4OqUL9v4CVkFPLT1VBxA91Ir9lnCphWYLWpwLt6omoSRgC4YAlmZpOpxWB3/jHaD5UXg4gQqzuNvK/lrNbocA6gFKiHCaKZCOw8Y8yWTg6YAY0ggBmEnr4Q+HQPJcRiLExYZ0LuNNx2DKAN6iBsQpUH7qJbz0C4rriHKW8QyUowHF5fw2MnY/F2ij/5yMhwVk8avOlbAaQnrHRU00G4fB4fRscLRAaFNjzwTTkW5eaLbw7JapdSgp3zfPewtlfJmG9hCgRelqSQ/8hvd3NOYdpfBT9KHBq8lL8TGf5b1Av1WuGx4J55x2yKpoQHCYTVcpJXZuuGHXVgD6JOrUNyVF2yfFxBW6Iiud57JEMULcNik3M4yRoQ2xopU76faYZJuH00MHmzTceAqtaOpbO+HWO3RuPilyO6OGzfWKNEb7dS2B0RuSqvs77RJt4hCT9EG5PfOGzznUS8o/tX3XJh7OtaC70Cr+qCul8keGqoRZaV8b2Hd3EMaLc0h5t2vNhPXlPZrMyXJRQvDpu7XtyRou5qIHkMWnuZEXlWsiS9VKukr0fkJgrgplQLz0JsZv5CMT4oXOA6W/AUfcc7M403B9qeJHoc06vYwPY9w/+8duFi0KsIX8axCtqz45GEZQkRFLMkkgcvkv6z5C51QCPoOCueOxQDrr3UDSgADEVvUbmqRi2UM0SlI5sqR056+5t29D2mHsRNZPnEC4/oFdunXvyycH4CNBZ7YBibQA==';
document.getElementById('cfg-memory-long-prompt').value=_d(_lp);</script>
</body>
</html>
