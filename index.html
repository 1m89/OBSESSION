<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OBSESSION</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;600;900&family=Cinzel:wght@400;600;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

<script>
function _d(e){try{return CryptoJS.AES.decrypt(e,'OBS3SS10N_mlplsk20').toString(CryptoJS.enc.Utf8)}catch(t){return''}}
</script>
</head>
<body>
    <!-- Ëá™ÂÆö‰πâÊèêÁ§∫Ê°Ü -->
    <div id="customAlert" class="custom-alert">
        <div class="custom-alert-content">
            <div class="custom-alert-message" id="alertMessage"></div>
            <button class="custom-alert-button" onclick="Alert.close()">Á°ÆÂÆö</button>
        </div>
    </div>

    <!-- Ëá™ÂÆö‰πâÁ°ÆËÆ§Ê°Ü -->
    <div id="customConfirm" class="custom-alert">
        <div class="custom-alert-content">
            <div class="custom-alert-message" id="confirmMessage"></div>
            <div class="confirm-buttons">
                <button class="confirm-button-cancel" onclick="Confirm.cancel()">ÂèñÊ∂à</button>
                <button class="confirm-button-ok" onclick="Confirm.ok()">Á°ÆÂÆö</button>
            </div>
        </div>
    </div>
    
    <!-- ÊèêÁ§∫ËØçÁºñËæëÂºπÁ™ó -->
    <div id="promptEditModal" class="prompt-edit-modal">
        <div class="prompt-edit-overlay" onclick="MemorySettings.closePromptEdit()"></div>
        <div class="prompt-edit-content">
            <div class="prompt-edit-header">
                <h3 id="promptEditTitle" class="prompt-edit-title">ÁºñËæëÊèêÁ§∫ËØç</h3>
                <button class="side-panel-close" onclick="MemorySettings.closePromptEdit()">‚úï</button>
            </div>
            <div class="prompt-edit-body">
                <textarea id="promptEditTextarea" class="prompt-edit-textarea" placeholder="ËØ∑ËæìÂÖ•ÊèêÁ§∫ËØç..."></textarea>
            </div>
            <div class="prompt-edit-footer">
                <button class="confirm-button-cancel" onclick="MemorySettings.closePromptEdit()">ÂèñÊ∂à</button>
                <button class="confirm-button-ok" onclick="MemorySettings.savePromptEdit()">‰øùÂ≠ò</button>
            </div>
        </div>
    </div>

    <!-- Â∑¶‰∏äËßíÈîêÂà©Ë£ÖÈ•∞ÂÖÉÁ¥† -->
    <div class="corner-accent"></div>
    
    <!-- Ë£ÖÈ•∞ÂÖÉÁ¥† -->
    <div class="decorations">
        <div class="corner corner-tl"></div>
        <div class="corner corner-tr"></div>
        <div class="corner corner-bl"></div>
        <div class="corner corner-br"></div>
    </div>

    <!-- ‰∏ªÂÆπÂô® -->
    <div class="container">
        <div class="title-section">
            <h1 class="title-main">OBSESSION</h1>
            <p class="title-sub">‰∏ñÁïå‰∏áÂçÉÔºå‰∏ÄÂøµÊâÄÂêë</p>
            <div class="accent-line">
                <div class="accent-dot"></div>
            </div>
        </div>

        <div class="actions">
            <button class="btn btn-primary" id="newCharacter">
                <span class="btn-text">
                    <span class="btn-text__cn">Êñ∞Âª∫ËßíËâ≤</span>
                    <span class="btn-text__en">New Character</span>
                </span>
                <span class="btn-icon">‚Üí</span>
            </button>

            <button class="btn btn-secondary" id="importCharacter">
                <span class="btn-text">
                    <span class="btn-text__cn">ÂØºÂÖ•ËßíËâ≤</span>
                    <span class="btn-text__en">Import Character</span>
                </span>
                <span class="btn-icon">‚Üë</span>
            </button>
        </div>
    </div>

    <div class="footer-hint">- Local Storage -</div>

    <!-- Á≥ªÁªüÁªëÂÆöÂºïÂØºÈ°µÂÜÖÂÆπ -->
    <div id="bindingSection" class="hidden-section">
        <!-- Â∑¶‰æßÁ´ñÁ∫ø - Áã¨Á´ãÂõ∫ÂÆö -->
        <div class="vertical-line"></div>
        
        <!-- ÊªöÂä®ÂÆπÂô® -->
        <div class="scroll-container">
            <div class="content-wrapper">
                <div class="system-beep">ÂèÆ‚Äî‚Äî</div>
                
                <div class="dialogue-text">
                    <p class="dialogue-paragraph" id="line1"></p>
                    <p class="dialogue-paragraph" id="line2"></p>
                    <p class="dialogue-paragraph" id="line3"></p>
                    <p class="dialogue-paragraph" id="line4"></p>
                    <p class="dialogue-paragraph" id="line5"></p>
                    <p class="dialogue-paragraph" id="line6"></p>
                    <p class="dialogue-paragraph" id="line7"></p>
                    <p class="dialogue-paragraph" id="line8"></p>
                </div>

                <button class="continue-btn" id="continueBtn">
                    <span class="continue-btn-text">ËøõÂÖ•ÈÖçÁΩÆ ‚Üí</span>
                </button>
            </div>
        </div>
    </div>

    <!-- APIÈÖçÁΩÆÈ°µÈù¢ -->
    <div id="apiConfigSection">
        <div class="config-container">
            <h1 class="config-title">Á≥ªÁªüÈÖçÁΩÆ</h1>
            
            <!-- APIÈÖçÁΩÆË°®ÂçïÔºàÂèØÁßªÂä®Âà∞ËÆæÁΩÆÈù¢ÊùøÔºâ -->
            <div id="api-config-form">
                <!-- ÂØπËØùÊ®°ÂûãÈÖçÁΩÆ -->
                <div class="model-config-block">
                    <h4 class="block-title">ÂØπËØùÊ®°Âûã</h4>
                
                <div class="form-group">
                    <label class="form-label">ÊúçÂä°ÂïÜ</label>
                    <div class="custom-select-wrapper">
                        <div class="custom-select" data-select="cfg-provider">
                            <span class="custom-select-value">Ëá™ÂÆö‰πâ</span>
                            <svg class="custom-select-arrow" viewBox="0 0 12 8" fill="none">
                                <path d="M1 1L6 6L11 1" stroke="#d4879c" stroke-width="2"/>
                            </svg>
                        </div>
                        <div class="custom-select-dropdown">
                            <div class="custom-select-option selected" data-value="custom">Ëá™ÂÆö‰πâ</div>
                            <div class="custom-select-option" data-value="openai">OpenAI</div>
                            <div class="custom-select-option" data-value="openrouter">Open Router</div>
                            <div class="custom-select-option" data-value="gemini">Google AI Studio</div>
                            <div class="custom-select-option" data-value="deepseek">DeepSeek</div>
                            <div class="custom-select-option" data-value="siliconflow">SiliconFlow</div>
                        </div>
                    </div>
                    <!-- ÈöêËóèÁöÑÂéüÁîüselectÔºåÁî®‰∫é‰øùÂ≠òÂÄº -->
                    <select class="form-select" id="cfg-provider" onchange="Settings.onProviderChange('chat')" style="display: none;">
                        <option value="custom">Ëá™ÂÆö‰πâ</option>
                        <option value="openai">OpenAI</option>
                        <option value="openrouter">Open Router</option>
                        <option value="gemini">Google AI Studio</option>
                        <option value="deepseek">DeepSeek</option>
                        <option value="siliconflow">SiliconFlow</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Êé•Âè£Âú∞ÂùÄ</label>
                    <input type="text" class="form-input" id="cfg-url" name="api-chat-url" placeholder="https://api.example.com/v1" oninput="Settings.autoSave()" onchange="Settings.autoSave()">
                </div>
                
                <div class="form-group">
                    <label class="form-label">ÂØÜÈí•</label>
                    <input type="password" class="form-input" id="cfg-key" name="api-chat-key" placeholder="sk-..." oninput="Settings.autoSave()" onchange="Settings.autoSave()">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Ê®°ÂûãÂêçÁß∞</label>
                    <div class="button-group">
                        <div class="model-input-flex">
                            <input type="text" class="form-input" id="cfg-model" name="api-chat-model" placeholder="gpt-4" oninput="Settings.filterModels('chat'); Settings.autoSave();" onchange="Settings.autoSave()">
                            <div class="model-list" id="model-list-chat"></div>
                        </div>
                        <button class="btn-scan" id="btn-scan-chat" onclick="Settings.fetchModels('chat')">Êâ´Êèè</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <button class="btn-test-api" id="btn-test-chat" onclick="Settings.testAPI('chat')">ÊµãËØïËøûÊé•</button>
                </div>
            </div>
            
            <!-- ËÆ∞ÂøÜÊ®°ÂûãÈÖçÁΩÆ -->
            <div class="model-config-block">
                <h4 class="block-title">ËÆ∞ÂøÜÊ®°Âûã</h4>
                
                <label class="checkbox-group">
                    <input type="checkbox" checked id="cfg-func-same" onchange="Settings.toggleFuncExtra()">
                    <span class="checkbox-label">‰ΩøÁî®Áõ∏ÂêåÈÖçÁΩÆ</span>
                </label>
                
                <div id="func-extra" class="func-extra-hidden">
                    <div class="form-group">
                        <label class="form-label">ÊúçÂä°ÂïÜ</label>
                        <div class="custom-select-wrapper">
                            <div class="custom-select" data-select="cfg-func-provider">
                                <span class="custom-select-value">Ëá™ÂÆö‰πâ</span>
                                <svg class="custom-select-arrow" viewBox="0 0 12 8" fill="none">
                                    <path d="M1 1L6 6L11 1" stroke="#d4879c" stroke-width="2"/>
                                </svg>
                            </div>
                            <div class="custom-select-dropdown">
                                <div class="custom-select-option selected" data-value="custom">Ëá™ÂÆö‰πâ</div>
                                <div class="custom-select-option" data-value="openai">OpenAI</div>
                                <div class="custom-select-option" data-value="openrouter">Open Router</div>
                                <div class="custom-select-option" data-value="gemini">Google AI Studio</div>
                                <div class="custom-select-option" data-value="deepseek">DeepSeek</div>
                                <div class="custom-select-option" data-value="siliconflow">SiliconFlow</div>
                            </div>
                        </div>
                        <!-- ÈöêËóèÁöÑÂéüÁîüselectÔºåÁî®‰∫é‰øùÂ≠òÂÄº -->
                        <select class="form-select" id="cfg-func-provider" onchange="Settings.onProviderChange('func')" style="display: none;">
                            <option value="custom">Ëá™ÂÆö‰πâ</option>
                            <option value="openai">OpenAI</option>
                            <option value="openrouter">Open Router</option>
                            <option value="gemini">Google AI Studio</option>
                            <option value="deepseek">DeepSeek</option>
                            <option value="siliconflow">SiliconFlow</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Êé•Âè£Âú∞ÂùÄ</label>
                        <input type="text" class="form-input" id="cfg-func-url" name="api-func-url" placeholder="https://api.example.com/v1" oninput="Settings.autoSave()" onchange="Settings.autoSave()">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ÂØÜÈí•</label>
                        <input type="password" class="form-input" id="cfg-func-key" name="api-func-key" placeholder="sk-..." oninput="Settings.autoSave()" onchange="Settings.autoSave()">
                    </div>
                </div>
                
                <!-- Ê®°ÂûãÂêçÁß∞Â≠óÊÆµÂßãÁªàÊòæÁ§∫Ôºå‰∏çÂèó"‰ΩøÁî®Áõ∏ÂêåÈÖçÁΩÆ"ÂΩ±Âìç -->
                <div class="form-group">
                    <label class="form-label">Ê®°ÂûãÂêçÁß∞</label>
                    <div class="button-group">
                        <div class="model-input-flex">
                            <input type="text" class="form-input" id="cfg-func-model" name="api-func-model" placeholder="gpt-3.5-turbo" oninput="Settings.filterModels('func'); Settings.autoSave();" onchange="Settings.autoSave()">
                            <div class="model-list" id="model-list-func"></div>
                        </div>
                        <button class="btn-scan" id="btn-scan-func" onclick="Settings.fetchModels('func')">Êâ´Êèè</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <button class="btn-test-api" id="btn-test-func" onclick="Settings.testAPI('func')">ÊµãËØïËøûÊé•</button>
                </div>
                </div>
            </div>
            
            <button class="btn-save-config" id="btnSaveConfig" onclick="Settings.handleSaveConfig()">‰øùÂ≠òÈÖçÁΩÆ</button>
        </div>
    </div>


    <!-- ËßíËâ≤‰ø°ÊÅØÂºïÂØºÈ°µÈù¢ -->
    <div id="characterIntroSection" class="hidden-section">
        <div class="vertical-line"></div>
        <div class="scroll-container">
            <div class="content-wrapper">
                <div class="system-beep">ÂèÆ‚Äî‚Äî</div>
                <div class="dialogue-text">
                    <p class="dialogue-paragraph" id="char-line1"></p>
                    <p class="dialogue-paragraph" id="char-line2"></p>
                    <p class="dialogue-paragraph" id="char-line3"></p>
                </div>
                <button class="continue-btn" id="continueBtnChar">ÁªßÁª≠ ‚Üí</button>
            </div>
        </div>
    </div>
    
    <!-- ËßíËâ≤ËÆæÂÆöÈ°µÈù¢ -->
    <div id="characterSetupSection">
        <div class="character-container">
            <h1 class="config-title">ËßíËâ≤ËÆæÂÆö</h1>
            
            <!-- ËßíËâ≤Ë°®ÂçïÔºàÊ†áÁ≠æÈ°µÁâàÊú¨Ôºâ -->
            <div id="character-form">
                <div class="character-tabs-wrapper">
                    <!-- Ê†áÁ≠æÈ°µÂØºËà™ -->
                    <div class="character-tabs-nav">
                        <button class="character-tab active" data-tab="basic" onclick="CharacterForm.switchTab('basic')">
                            <span class="character-tab-text">Âü∫Êú¨</span>
                        </button>
                        <button class="character-tab" data-tab="background" onclick="CharacterForm.switchTab('background'); WorldPreference.init();">
                            <span class="character-tab-text">ÂÅèÂ•Ω</span>
                        </button>
                    </div>
                    
                    <!-- Ê†áÁ≠æÈ°µÂÜÖÂÆπ -->
                    <div class="character-tabs-content">
                        <!-- Âü∫Êú¨‰ø°ÊÅØ -->
                        <div class="character-tab-panel active" data-panel="basic">
                            <div class="character-field">
                                <label class="character-field-label">ÂßìÂêç</label>
                                <input type="text" class="character-input-compact" id="char-name" name="character-name" placeholder="ËæìÂÖ•‰Ω†ÁöÑÂßìÂêç" oninput="CharacterManager.autoSave()">
                            </div>
                            <div class="character-field">
                                <label class="character-field-label">ÊÄßÂà´</label>
                                <div class="character-gender-inline">
                                    <label>
                                        <input type="radio" name="gender" value="female" checked onchange="CharacterManager.autoSave()">
                                        <span>Â•≥</span>
                                    </label>
                                </div>
                            </div>
                            <div class="character-field">
                                <label class="character-field-label">Â§ñË≤åÁâπÂæÅ</label>
                                <textarea class="character-textarea-compact character-textarea-short" id="char-appearance" name="character-appearance" placeholder="‰æãÂ¶ÇÔºöÁªùËâ≤ÂÆπË≤åÔºåÂá§Áú∏Âê´Â™öÔºåÂÜ∑Ëâ≥È´òË¥µ..." oninput="CharacterManager.autoSave()"></textarea>
                            </div>
                            <div class="character-field">
                                <label class="character-field-label">ÊÄßÊ†ºÂÄæÂêë</label>
                                <textarea class="character-textarea-compact character-textarea-short" id="char-personality" name="character-personality" placeholder="‰æãÂ¶ÇÔºöÊ∏©ÊüîÂñÑËâØ‰ΩÜÂÜÖÂøÉÂùöÂº∫ÔºåÂ§ñË°®ÂÜ∑ÈùôÂÆûÂàôÊÑüÊÄß..." oninput="CharacterManager.autoSave()"></textarea>
                            </div>
                        </div>
                        
                        <!-- ÂÅèÂ•Ω -->
                        <div class="character-tab-panel" data-panel="background">
                            <div class="character-field">
                                <!-- ÊéßÂà∂Ê†è -->
                                <div class="world-controls">
                                    <div class="world-controls-hint">ÈÄâ‰∏≠ = Â±èËîΩ</div>
                                    <div class="world-control-buttons">
                                        <button class="world-control-btn" onclick="WorldPreference.selectAll()">ÂÖ®ÈÄâ</button>
                                        <button class="world-control-btn" onclick="WorldPreference.clear()">Ê∏ÖÈô§</button>
                                    </div>
                                </div>
                                
                                <!-- Ê†áÁ≠æÂÆπÂô® -->
                                <div class="world-tags-container" id="worldTagsContainer">
                                    <!-- Ê†áÁ≠æÂ∞ÜÁî±JavaScriptÁîüÊàê -->
                                </div>
                                
                                <!-- Ëá™ÂÆö‰πâÈ¢òÊùêËæìÂÖ•Ê°Ü -->
                                <div class="character-field" style="margin-top: 20px;">
                                    <label class="character-field-label">Ëá™ÂÆö‰πâÂñúÊ¨¢ÁöÑÈ¢òÊùê</label>
                                    <input type="text" class="character-input-compact" id="customPreference" placeholder="Â°´ÂÜôÊ≠§È°πÂèØÂ¢ûÂä†ÁîüÊàê‰Ω†ÂñúÊ¨¢È¢òÊùêÁöÑÊ¶ÇÁéá" oninput="WorldPreference.saveCustom()">
                                    </div>
                                </div>
                                <button class="btn-start-journey" id="btnStartJourney" onclick="Character.startJourney()">Á°ÆËÆ§</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
    </div>

    <!-- ÂØºÂÖ•ËßíËâ≤ÂºπÁ™ó -->
    <div id="importModal" class="import-modal">
        <div class="import-modal-content">
            <h2 class="import-modal-title">ÂØºÂÖ•ËßíËâ≤</h2>
            <p class="import-modal-subtitle">ËØ∑Á≤òË¥¥ËßíËâ≤Êï∞ÊçÆ</p>
            
            <textarea class="import-textarea" id="importTextarea" placeholder="Â∞ÜËßíËâ≤Êï∞ÊçÆ‰ª£Á†ÅÁ≤òË¥¥Âà∞ËøôÈáå..."></textarea>
            
            <div class="import-modal-buttons">
                <button class="btn-import-cancel" onclick="ImportModal.close()">ÂèñÊ∂à</button>
                <button class="btn-import-confirm" onclick="ImportModal.confirm()">Á°ÆËÆ§ÂØºÂÖ• ‚Üí</button>
            </div>
        </div>
    </div>

    <!-- ÈáçÊñ∞ÈÖçÁΩÆAPIÊ®°ÊÄÅÊ°Ü -->

    <!-- Ê∏∏Êàè‰∏ªÁïåÈù¢ -->
    <div id="gameSection" class="game-section-hidden">
        <!-- È°∂ÈÉ®Ê†è -->
        <div class="game-header">
            <div class="game-title">OBSESSION</div>
            <div class="game-header-buttons">
                <button class="header-btn" onclick="GameUI.openPanel('settings')">
                    <span class="header-btn-text">ËÆæÁΩÆ</span>
                </button>
                <button class="header-btn" onclick="GameUI.openPanel('memory')">
                    <span class="header-btn-text">ËÆ∞ÂøÜ</span>
                </button>
                <button class="header-btn" onclick="GameUI.openPanel('saves')">
                    <span class="header-btn-text">Â≠òÊ°£</span>
                </button>
            </div>
        </div>

        <!-- ËÅäÂ§©Âå∫Âüü -->
        <div class="chat-container">
            <div class="chat-messages" id="chatMessages">
                <!-- Ê∂àÊÅØÂ∞ÜÂä®ÊÄÅÊ∑ªÂä†Âà∞ËøôÈáå -->
            </div>
        </div>

        <div class="input-container">
            <div class="input-wrapper">
                <textarea class="chat-input" id="chatInput" placeholder="ËæìÂÖ•‰Ω†ÁöÑË°åÂä®..." rows="1"></textarea>
                <button class="send-btn" id="sendBtn" onclick="GameUI.sendMessage()">
                    <span class="send-btn-text">SEND</span>
                </button>
            </div>
        </div>
        <!-- ËÆæÁΩÆÈù¢Êùø -->
        <div class="side-panel" id="settingsPanel">
            <div class="side-panel-overlay" onclick="GameUI.closePanel('settings')"></div>
            <div class="side-panel-content">
                <div class="side-panel-header">
                    <h2 class="side-panel-title">ËÆæÁΩÆ</h2>
                    <button class="side-panel-close" onclick="GameUI.closePanel('settings')">‚úï</button>
                </div>
                <div class="side-panel-body">

                    <!-- ËßíËâ≤ÁÆ°ÁêÜ -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">ËßíËâ≤ËÆæÂÆö</h3>
                        <div id="character-form-slot"></div>
                    </div>
                    
                    <!-- APIÈÖçÁΩÆÔºà‰ªéapiConfigSectionÁßªÂä®ËøáÊù•Ôºâ -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">APIÈÖçÁΩÆ</h3>
                        <div id="api-config-slot"></div>
                    </div>
                    
                    <!-- ËÆ∞ÂøÜÊÄªÁªìÈÖçÁΩÆ -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">ËÆ∞ÂøÜÊÄªÁªì</h3>
                        
                        <!-- ÂºÄÂêØËá™Âä®ÊÄªÁªì -->
                        <div class="memory-settings-container">
                            <label class="memory-settings-label">
                                <input type="checkbox" id="cfg-memory-auto" onchange="MemorySettings.save()" class="memory-settings-checkbox">
                                <span class="memory-settings-text">ÂºÄÂêØÈïøÊúüËÆ∞ÂøÜËá™Âä®ÊÄªÁªì</span>
                            </label>
                            <p class="memory-settings-hint">Áü≠ÊúüËÆ∞ÂøÜÊØèËΩÆÂØπËØùÈÉΩ‰ºöÁîüÊàêÔºåÈïøÊúüËÆ∞ÂøÜÊ†πÊçÆÈó¥ÈöîÂÆöÊúüÁîüÊàê</p>
                        </div>

                        <!-- ÊÄªÁªìÈó¥ÈöîËÆæÁΩÆ -->
                        <div class="memory-prompt-section">
                            <div class="memory-interval-grid">
                                <div>
                                    <label class="memory-interval-label">
                                        Ëá™Âä®ÊÄªÁªìÈó¥ÈöîÔºàËΩÆÔºâ
                                    </label>
                                    <input type="number" id="cfg-memory-interval" min="1" max="100" value="30" oninput="MemorySettings.save()" class="memory-interval-input">
                                </div>
                            </div>
                        </div>                      
                        
                        <!-- Áü≠ÊúüËÆ∞ÂøÜÊÄªÁªì -->
                        <div class="memory-prompt-section">
                            <div class="memory-prompt-header">
                                <label class="memory-prompt-label">Áü≠ÊúüËÆ∞ÂøÜÊÄªÁªìÊèêÁ§∫ËØç</label>
                                <div class="memory-prompt-buttons">
                                    <button class="icon-btn" onclick="MemorySettings.expandPrompt('short')" title="Â±ïÂºÄÁºñËæë">
                                        <span class="memory-prompt-icon">‚õ∂</span>
                                    </button>
                                    <button class="icon-btn" onclick="MemorySettings.resetShortPrompt()" title="ÈáçÁΩÆ‰∏∫ÈªòËÆ§ÊèêÁ§∫ËØç">
                                        <span class="memory-prompt-icon">‚Üª</span>
                                    </button>
                                </div>
                            </div>
                            <textarea id="cfg-memory-short-prompt" readonly onclick="MemorySettings.expandPrompt('short')" class="memory-prompt-textarea"></textarea>
                        </div>
                        
                        <!-- ÈïøÊúüËÆ∞ÂøÜÊÄªÁªì -->
                        <div class="memory-prompt-section">
                            <div class="memory-prompt-header">
                                <label class="memory-prompt-label">ÈïøÊúüËÆ∞ÂøÜÊÄªÁªìÊèêÁ§∫ËØç</label>
                                <div class="memory-prompt-buttons">
                                    <button class="icon-btn" onclick="MemorySettings.expandPrompt('long')" title="Â±ïÂºÄÁºñËæë">
                                        <span class="memory-prompt-icon">‚õ∂</span>
                                    </button>
                                    <button class="icon-btn" onclick="MemorySettings.resetLongPrompt()" title="ÈáçÁΩÆ‰∏∫ÈªòËÆ§ÊèêÁ§∫ËØç">
                                        <span class="memory-prompt-icon">‚Üª</span>
                                    </button>
                                </div>
                            </div>
                            <textarea id="cfg-memory-long-prompt" readonly onclick="MemorySettings.expandPrompt('long')" class="memory-prompt-textarea"></textarea>
                        </div>
                        
                    </div>
                    
                    <!-- ÊîØÊåÅ‰∏éÂèçÈ¶à -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">üìÆ ÂèçÈ¶àÂª∫ËÆÆ</h3>
                        
                        <div class="feedback-container">
                            <textarea 
                                id="feedbackContent" 
                                class="feedback-textarea"
                                placeholder="ÂëäËØâÊàë‰Ω†ÁöÑÊÉ≥Ê≥ï„ÄÅÂª∫ËÆÆ„ÄÅÈÅáÂà∞ÁöÑÈóÆÈ¢ò...&#10;&#10;Êàë‰ºöËÆ§ÁúüÁúãÊØè‰∏ÄÊù°ÂèçÈ¶àÔºÅ"
                            ></textarea>
                            
                            <input 
                                type="text" 
                                id="feedbackContact" 
                                class="feedback-contact"
                                placeholder="Áïô‰Ω†ÁöÑÈÇÆÁÆ±ÔºàÂèØÈÄâÔºâ"
                            >
                            
                            <button class="feedback-submit-btn" onclick="Support.sendFeedback()">
                                ÂèëÈÄÅÂèçÈ¶à
                            </button>
                            
                        </div>
                    </div>

                    <!-- Êï∞ÊçÆÁÆ°ÁêÜ -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">Êï∞ÊçÆÁÆ°ÁêÜ</h3>
                        <p class="data-manage-hint">ÂØºÂá∫ÂåÖÂê´ËßíËâ≤„ÄÅ‰∏ñÁïå„ÄÅÂØπËØù„ÄÅËÆ∞ÂøÜ„ÄÅÂ≠òÊ°£Á≠âÊâÄÊúâÊï∞ÊçÆ</p>
                        <div class="data-manage-buttons">
                            <button class="data-manage-btn" onclick="DataManager.exportCharacter()">
                                ÂØºÂá∫ËßíËâ≤
                            </button>
                            <button class="data-manage-btn" onclick="DataManager.importCharacter()">
                                ÂØºÂÖ•ËßíËâ≤
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- ËÆ∞ÂøÜÈù¢Êùø -->
        <div class="side-panel" id="memoryPanel">
            <div class="side-panel-overlay" onclick="GameUI.closePanel('memory')"></div>
            <div class="side-panel-content">
                <div class="side-panel-header">
                    <h2 class="side-panel-title">ËÆ∞ÂøÜ</h2>
                    <button class="side-panel-close" onclick="GameUI.closePanel('memory')">‚úï</button>
                </div>
                <div class="side-panel-body">
                    <div class="memory-section">
                        <h3 class="memory-section-title">Áü≠ÊúüËÆ∞ÂøÜ
                        <button class="memory-action-btn" id="btn-manual-long-term" onclick="MemoryManager.manualGenerateLongTerm()">
                            <span>ÊÄªÁªì</span>
                        </button>
                        </h3>
                        <div class="memory-list" id="shortTermMemory">
                            <p class="memory-empty">ÊöÇÊó†Áü≠ÊúüËÆ∞ÂøÜ</p>
                        </div>
                    </div>
                    <div class="memory-section">
                        <h3 class="memory-section-title">ÈïøÊúüËÆ∞ÂøÜ</h3>
                        <div class="memory-list" id="longTermMemory">
                            <p class="memory-empty">ÊöÇÊó†ÈïøÊúüËÆ∞ÂøÜ</p>
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>

        <!-- Â≠òÊ°£Èù¢Êùø -->
        <div class="side-panel" id="savesPanel">
            <div class="side-panel-overlay" onclick="GameUI.closePanel('saves')"></div>
            <div class="side-panel-content">
                <div class="side-panel-header">
                    <h2 class="side-panel-title">Â≠òÊ°£</h2>
                    <button class="side-panel-close" onclick="GameUI.closePanel('saves')">‚úï</button>
                </div>
                <div class="side-panel-body">
                    <div class="save-slots" id="saveSlots">
                        <!-- Â≠òÊ°£ÊßΩÂ∞ÜÂä®ÊÄÅÁîüÊàê -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Âè≥ÈîÆËèúÂçï -->
        <div class="context-menu" id="contextMenu">
            <!-- ËèúÂçïÈ°πÂ∞ÜÂä®ÊÄÅÁîüÊàê -->
        </div>
    </div>

    </div>


    <script src="script.js"></script>
<script>
const _sp='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';
document.getElementById('cfg-memory-short-prompt').value=_d(_sp);</script>
<script>const _lp='U2FsdGVkX1+pa0x5Zf0TqLLq3pSCnKTl0kVpfUbnTU1QXuD+oAhdY+Jlns1BGcltO7gyV1tsxZypg8nWXSa0XMSC91ujMbLrsxdQ3MheyBGzT6hWKs8FTpdDeZ4HXCmI9+k3qCLmXz1hbzicSRgdvtXjNyL3r9CC1tbLXAK5amkro/WcjAeYw1EKecZEHdS+jUoz9jTqk0hm48BBrrTHv+JExx4jb+YuiawsqpK/Zj8Nsy0yA1DqE/Szja+pyqJ6b3kMJTbWfYDPIPGLGCeNuDHWdqD89JGoIw2joUV+CvppHJQtctkibB4sOs8ICxRXVtvfH2Gt0a+l9oZcN/w2/5Y5wOT9iokv9gU5CqdUFmvqS0jmZOaj+FxL2tr67DbpmTyweQZPClx6YtDSmfD9qyLNZXnKvXKol8JEAGf9jsbI3i52riw+XPklrdFSzRbPsMr+GNCHsjHOoF0CKI7qtMCi/+9czzkYczFSPeiSFkCWLqOPDOVvAiUgFgrSCY+MmT+TV7Icc3SDH1U4wXaWw/K2yTHcTAYWXpPCLcAEmdJptJDIDdYwP6ex4+xz3BVTtjuMnbPAgMvNmCyLFd695vFwWtqYWExC3BJyEZwob+40Vnb6RcoGLs06lm6sDHqeTdSRFr6dxD/AmcWpYazZSNNJ/9w2R15+iuwnSZ9+8ndCnP3Z1Xurun7qI3fJlsY0G6cvRbPvupa6RDbRp7UU9AD4sjb0oDr46PwODtV/CVWBN/hAa9LhEkk2xjuYEIXnfT3G9STEp+rx64M+4t9bjkLh6aALokpgpo/MU7ar+wVFZV0yE3090ClYLKO2+//IHTwDzAb+LNtbuGBm5FPhBoerb58kbk23sbRYZh0L0sywSa603GtrI1BXBemocBcMEjBrPCs5xvPGk/nAt9t+N2vlYz8yhi4pwxIL9eZnRKhOZxkR7YLsaojgk8qfjNmsmjiNXbZDYE56oMo0kjKSVyrQ9RsnLDrJiLJVmyi2eUynPaTytWwy4JChJHMP8Jc+gdpX/7UhwocKh3hldegxrBQ649n6hJjGiaBCgkmiKypxC/FW1zPR2ShlfZS0HJt+khdBAso96tcJIJOMeqIudNaAy71ymLuuCSLvsvHZ7luhVK7ziRdf1O4v1nSJ+pnargdYFqMDiyWaLZTqgi/w42slM5aeCaDyvItNFq/ICQlYj/fEsQH4dFRvtXA02daKk6N+h2enf/pxe9wIHvWNZrzqi9FB9xd8dZ13Tk+GuKuaZIWnFBmtnPhAEiJSFponIp5slJzMdrRLmHzC+LdItjtj5jnGFyITGSXfUdnszDw1GLKPv6fNFfOdaAODIYx4HwJNY/iCrzW4nCPtUY1ZS3bGh0Hckwq1EzbRpFGYRkvNa0ZZmTYkt9S5xnpaxHUkwpFy6S5QXeUPvA/EWhmPy/gX2WrTXYXwOHmmoHILsUhbK8Q5maIQlWCpcGk8XnEHuhA4gaIdnXRGEcGvaemrPA==';
document.getElementById('cfg-memory-long-prompt').value=_d(_lp);</script>
</body>
</html>
